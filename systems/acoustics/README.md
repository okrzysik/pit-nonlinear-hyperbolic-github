This directory implements the acoustics examples from the paper `Parallel-in-time solution of hyperbolic PDE systems via characteristic-variable block preconditioning`

Here we solve the acoustics equation:   

    [p,u]_t + A0(x)*[p,u]_x = 0, A0 = [0, K0(x); 1/rho0(x), 0].
K0 and rho0 are material parameters, and they are related to the sound speed c0 and impedance Z0.
    

Figures 1 and 2 from the paper can be generated by running the script `acoustics_st_preconditioning.m` with various options configured as described in the paper. Some of the main options in the code that need to be configured are:

* prec_id: This specifies whether diagonal or triangular block preconditioning

* prec_application: Specifies whether diagonal blocks in the preconditioner are inverted exactly using time-stepping or inexactly using a single MGRIT V-cycle

* approximate_diag_blocks: Specifies whether diagonal blocks in the preconditioner are based on a Godunov discretization of advection equations or exactly transforming the acoustics discretization into characteristic variables
 
* pde_pa.mat_param_id: Specifies the material parameters. When you run the code it will plot the material parameters used; otherwise, the specific parameters are implemented in `acoustics_material_parameters.m`

* `MGRIT parameters`: This block of code sets up the parameters for MGRIT. To reproduce the figures from the paper ensure the same settings are used as described there. 


A description of the main scripts and directories is as follows:
* `acoustics_time_stepping.m` solves these equations by sequential time-stepping. This is the most basic script.

* `acoustics_st_preconditioning.m` solves the space-time formulation of the acoustics equations using block-preconditioning strategies

* `step_advection_godunov_MGRIT.m` implements time-stepping operators for MGRIT for the linear advection equations w\_t \pm c0\*w\_x = 0 

* `acoustics_material_parameters.m` several example sound-speeds c0 and impedances Z0.

* `utils/` some useful routines

* `discretization/` scripts related to discretizing the equations. These are all related in one way or another to the Godunov discretization.
